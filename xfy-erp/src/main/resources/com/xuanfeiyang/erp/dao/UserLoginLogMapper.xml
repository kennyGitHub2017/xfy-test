<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xuanfeiyang.erp.dao.UserLoginLogDao">
	<select id="findPage" resultType="UserLoginLog">
		select ull.*, s.contacts seller_contacts from USER_LOGIN_LOG ull
		left join sellers s on s.id = ull.seller_id
		<where>
			<if test="params.userId != null">
				and USER_ID = #{params.userId, jdbcType=DECIMAL}
			</if>
			<if test="params.sellerId != null">
				and SELLER_ID = #{params.sellerId, jdbcType=DECIMAL}
			</if>
			<if test="params.loginTimeStart != null">
				and LOGIN_TIME >= #{params.loginTimeStart, jdbcType=TIMESTAMP}
			</if>
			<if test="params.loginTimeEnd != null">
				and LOGIN_TIME <![CDATA[<]]> #{params.loginTimeEnd, jdbcType=TIMESTAMP} + 1
			</if>
			<if test="params.sellerId == null and params.userId == null">
				and SELLER_ID > 1
			</if>
		</where>
		order by LOGIN_TIME desc
	</select>

	<insert id="insert" parameterType="UserLoginLog">
		insert into USER_LOGIN_LOG (USER_ID, USERNAME, SELLER_ID, LOGIN_IP, LOGIN_TIME)
		values (#{userId,jdbcType=DECIMAL}, #{username,jdbcType=VARCHAR}, #{sellerId,jdbcType=DECIMAL},
		#{loginIp,jdbcType=VARCHAR}, #{loginTime,jdbcType=TIMESTAMP})
	</insert>
</mapper>